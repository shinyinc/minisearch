{"version":3,"file":"index.js","sources":["../../src/SearchableMap/TreeIterator.js","../../src/SearchableMap/fuzzySearch.js","../../src/SearchableMap/SearchableMap.js","../../src/MiniSearch.js"],"sourcesContent":["/**\n* @private\n*/\nclass TreeIterator {\n  constructor (set, type) {\n    const node = set._tree\n    const keys = Object.keys(node)\n    this.set = set\n    this.type = type\n    this.path = keys.length > 0 ? [{ node, keys }] : []\n  }\n\n  next () {\n    const value = this.dive()\n    this.backtrack()\n    return value\n  }\n\n  dive () {\n    if (this.path.length === 0) { return { done: true } }\n    const { node, keys } = last(this.path)\n    if (last(keys) === LEAF) { return { done: false, value: this.result() } }\n    this.path.push({ node: node[last(keys)], keys: Object.keys(node[last(keys)]) })\n    return this.dive()\n  }\n\n  backtrack () {\n    if (this.path.length === 0) { return }\n    last(this.path).keys.pop()\n    if (last(this.path).keys.length > 0) { return }\n    this.path.pop()\n    this.backtrack()\n  }\n\n  key () {\n    return this.set._prefix + this.path\n      .map(({ keys }) => last(keys))\n      .filter(key => key !== LEAF)\n      .join('')\n  }\n\n  value () {\n    return last(this.path).node[LEAF]\n  }\n\n  result () {\n    if (this.type === VALUES) { return this.value() }\n    if (this.type === KEYS) { return this.key() }\n    return [this.key(), this.value()]\n  }\n\n  [Symbol.iterator] () {\n    return this\n  }\n}\n\n/** @ignore */\nconst ENTRIES = 'ENTRIES'\n\n/** @ignore */\nconst KEYS = 'KEYS'\n\n/** @ignore */\nconst VALUES = 'VALUES'\n\n/** @ignore */\nconst LEAF = ''\n\nconst last = function (array) {\n  return array[array.length - 1]\n}\n\nexport { TreeIterator, ENTRIES, KEYS, VALUES, LEAF }\n","import { LEAF } from './TreeIterator.js'\n\n/**\n* @ignore\n*/\nexport const fuzzySearch = function (node, query, maxDistance) {\n  const stack = [{ distance: 0, i: 0, key: '', node }]\n  const results = {}\n  const innerStack = []\n\n  while (stack.length > 0) {\n    const { node, distance, key, i, edit } = stack.pop()\n    Object.keys(node).forEach((k) => {\n      if (k === LEAF) {\n        const totDistance = distance + (query.length - i)\n        const [, d] = results[key] || [null, Infinity]\n        if (totDistance <= maxDistance && totDistance < d) {\n          results[key] = [node[k], totDistance]\n        }\n      } else {\n        withinDistance(query, k, maxDistance - distance, i, edit, innerStack).forEach(({ distance: d, i, edit }) => {\n          stack.push({ node: node[k], distance: distance + d, key: key + k, i, edit })\n        })\n      }\n    })\n  }\n  return results\n}\n\n/**\n* @ignore\n*/\nexport const withinDistance = function (a, b, maxDistance, i, edit, stack) {\n  stack.push({ distance: 0, ia: i, ib: 0, edit })\n  const results = []\n\n  while (stack.length > 0) {\n    const { distance, ia, ib, edit } = stack.pop()\n\n    if (ib === b.length) {\n      results.push({ distance, i: ia, edit })\n      continue\n    }\n\n    if (a[ia] === b[ib]) {\n      stack.push({ distance, ia: ia + 1, ib: ib + 1, edit: NONE })\n    } else {\n      if (distance >= maxDistance) { continue }\n\n      if (edit !== ADD) {\n        stack.push({ distance: distance + 1, ia, ib: ib + 1, edit: DELETE })\n      }\n\n      if (ia < a.length) {\n        if (edit !== DELETE) {\n          stack.push({ distance: distance + 1, ia: ia + 1, ib, edit: ADD })\n        }\n\n        if (edit !== DELETE && edit !== ADD) {\n          stack.push({ distance: distance + 1, ia: ia + 1, ib: ib + 1, edit: CHANGE })\n        }\n      }\n    }\n  }\n\n  return results\n}\n\nconst NONE = 0\nconst CHANGE = 1\nconst ADD = 2\nconst DELETE = 3\n\nexport default fuzzySearch\n","import { TreeIterator, ENTRIES, KEYS, VALUES, LEAF } from './TreeIterator.js'\nimport fuzzySearch from './fuzzySearch.js'\n\n/**\n* A class implementing the same interface as a standard JavaScript `Map` with\n* string keys, but adding support for efficiently searching entries with prefix\n* or fuzzy search. This is the class internally used by `MiniSearch` as the\n* inverted index data structure. The implementation is a radix tree (compressed\n* prefix tree).\n*\n* @implements {Map}\n*/\nclass SearchableMap {\n  constructor (tree = {}, prefix = '') {\n    /** @private */\n    this._tree = tree\n    /** @private */\n    this._prefix = prefix\n  }\n\n  /**\n  * Creates and returns a mutable view of this `SearchableMap`, containing only\n  * entries that share the given prefix.\n  *\n  * @example\n  * let map = new SearchableMap()\n  * map.set(\"unicorn\", 1)\n  * map.set(\"universe\", 2)\n  * map.set(\"university\", 3)\n  * map.set(\"unique\", 4)\n  * map.set(\"hello\", 5)\n  *\n  * let uni = map.atPrefix(\"uni\")\n  * uni.get(\"unique\") // => 4\n  * uni.get(\"unicorn\") // => 1\n  * uni.get(\"hello\") // => undefined\n  *\n  * let univer = map.atPrefix(\"univer\")\n  * univer.get(\"unique\") // => undefined\n  * univer.get(\"universe\") // => 2\n  * univer.get(\"university\") // => 3\n  *\n  * @param {string} prefix - The prefix\n  * @return {SearchableMap} A `SearchableMap` representing a mutable view of the original Map at the given prefix\n  */\n  atPrefix (prefix) {\n    if (!prefix.startsWith(this._prefix)) { throw new Error('Mismatched prefix') }\n    const [node, path] = trackDown(this._tree, prefix.slice(this._prefix.length))\n    if (node === undefined) {\n      const [parentNode, key] = last(path)\n      const nodeKey = Object.keys(parentNode).find(k => k !== LEAF && k.startsWith(key))\n      if (nodeKey !== undefined) {\n        return new SearchableMap({ [nodeKey.slice(key.length)]: parentNode[nodeKey] }, prefix)\n      }\n    }\n    return new SearchableMap(node || {}, prefix)\n  }\n\n  /**\n  * @see https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Map/clear\n  * @return {undefined}\n  */\n  clear () {\n    delete this._size\n    this._tree = {}\n  }\n\n  /**\n  * @see https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Map/delete\n  * @param {string} key\n  * @return {undefined}\n  */\n  delete (key) {\n    delete this._size\n    return remove(this._tree, key)\n  }\n\n  /**\n  * @see https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Map/entries\n  * @return {Iterator}\n  */\n  entries () {\n    return new TreeIterator(this, ENTRIES)\n  }\n\n  /**\n   * @callback SearchableMap~forEachFn\n   * @param {string} key - Key\n   * @param {any} value - Value associated to key\n   * @return any\n   */\n\n  /**\n  * @see https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Map/forEach\n  * @param {SearchableMap~forEachFn} fn\n  * @return {undefined}\n  */\n  forEach (fn) {\n    for (const [key, value] of this) {\n      fn(key, value, this)\n    }\n  }\n\n  /**\n  * Returns a key-value object of all the entries that have a key within the\n  * given edit distance from the search key. The keys of the returned object are\n  * the matching keys, while the values are two-elements arrays where the first\n  * element is the value associated to the key, and the second is the edit\n  * distance of the key to the search key.\n  *\n  * @example\n  * let map = new SearchableMap()\n  * map.set('hello', 'world')\n  * map.set('hell', 'yeah')\n  * map.set('ciao', 'mondo')\n  *\n  * // Get all entries that match the key 'hallo' with a maximum edit distance of 2\n  * map.fuzzyGet('hallo', 2)\n  * // => { \"hello\": [\"world\", 1], \"hell\": [\"yeah\", 2] }\n  *\n  * // In the example, the \"hello\" key has value \"world\" and edit distance of 1\n  * // (change \"e\" to \"a\"), the key \"hell\" has value \"yeah\" and edit distance of 2\n  * // (change \"e\" to \"a\", delete \"o\")\n  *\n  * @param {string} key - The search key\n  * @param {number} maxEditDistance - The maximum edit distance\n  * @return {Object<string, Array>} A key-value object of the matching keys to their value and edit distance\n  */\n  fuzzyGet (key, maxEditDistance) {\n    return fuzzySearch(this._tree, key, maxEditDistance)\n  }\n\n  /**\n  * @see https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Map/get\n  * @param {string} key\n  * @return {any}\n  */\n  get (key) {\n    const node = lookup(this._tree, key)\n    return node !== undefined ? node[LEAF] : undefined\n  }\n\n  /**\n  * @see https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Map/has\n  * @param {string} key\n  * @return {boolean}\n  */\n  has (key) {\n    const node = lookup(this._tree, key)\n    return node !== undefined && node.hasOwnProperty(LEAF)\n  }\n\n  /**\n  * @see https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Map/keys\n  * @return {Iterator}\n  */\n  keys () {\n    return new TreeIterator(this, KEYS)\n  }\n\n  /**\n  * @see https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Map/set\n  * @param {string} key\n  * @param {any} value\n  * @return {SearchableMap} The `SearchableMap` itself, to allow chaining\n  */\n  set (key, value) {\n    if (typeof key !== 'string') { throw new Error('key must be a string') }\n    delete this._size\n    const node = createPath(this._tree, key)\n    node[LEAF] = value\n    return this\n  }\n\n  /**\n  * @see https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Map/size\n  * @type {number}\n  */\n  get size () {\n    if (this._size) { return this._size }\n    /** @ignore */\n    this._size = 0\n    this.forEach(() => { this._size += 1 })\n    return this._size\n  }\n\n  /**\n   * @callback SearchableMap~updateFn\n   * @param {any} currentValue - The current value\n   * @return any - the updated value\n   */\n\n  /**\n  * Updates the value at the given key using the provided function. The function\n  * is called with the current value at the key, and its return value is used as\n  * the new value to be set.\n  *\n  * @example\n  * // Increment the current value by one\n  * searchableMap.update('somekey', (currentValue) => currentValue == null ? 0 : currentValue + 1)\n  *\n  * @param {string} key - The key\n  * @param {SearchableMap~updateFn} fn - The function used to compute the new value from the current one\n  * @return {SearchableMap} The `SearchableMap` itself, to allow chaining\n  */\n  update (key, fn) {\n    if (typeof key !== 'string') { throw new Error('key must be a string') }\n    delete this._size\n    const node = createPath(this._tree, key)\n    node[LEAF] = fn(node[LEAF])\n    return this\n  }\n\n  /**\n  * @see https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Map/values\n  * @return {Iterator}\n  */\n  values () {\n    return new TreeIterator(this, VALUES)\n  }\n\n  /**\n  * @see https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Map/@@iterator\n  * @return {Iterator}\n  */\n  [Symbol.iterator] () {\n    return this.entries()\n  }\n}\n\n/**\n* Creates a `SearchableMap` from an `Iterable` of entries\n*\n* @param {Iterable|Array} entries - Entries to be inserted in the `SearchableMap`\n* @return {SearchableMap} A new `SearchableMap` with the given entries\n**/\nSearchableMap.from = function (entries) {\n  const tree = new SearchableMap()\n  for (const [key, value] of entries) {\n    tree.set(key, value)\n  }\n  return tree\n}\n\n/**\n* Creates a `SearchableMap` from the iterable properties of a JavaScript object\n*\n* @param {Object} object - Object of entries for the `SearchableMap`\n* @return {SearchableMap} A new `SearchableMap` with the given entries\n**/\nSearchableMap.fromObject = function (object) {\n  return SearchableMap.from(Object.entries(object))\n}\n\nconst trackDown = function (tree, key, path = []) {\n  if (key.length === 0) { return [tree, path] }\n  const nodeKey = Object.keys(tree).find(k => k !== LEAF && key.startsWith(k))\n  if (nodeKey === undefined) { return trackDown(undefined, '', [...path, [tree, key]]) }\n  return trackDown(tree[nodeKey], key.slice(nodeKey.length), [...path, [tree, nodeKey]])\n}\n\nconst lookup = function (tree, key) {\n  if (key.length === 0) { return tree }\n  const nodeKey = Object.keys(tree).find(k => k !== LEAF && key.startsWith(k))\n  if (nodeKey === undefined) { return undefined }\n  return lookup(tree[nodeKey], key.slice(nodeKey.length))\n}\n\nconst createPath = function (tree, key) {\n  if (key.length === 0) { return tree }\n  const nodeKey = Object.keys(tree).find(k => k !== LEAF && key.startsWith(k))\n  if (nodeKey === undefined) {\n    const toSplit = Object.keys(tree).find(k => k !== LEAF && k.startsWith(key[0]))\n    if (toSplit === undefined) {\n      tree[key] = {}\n    } else {\n      const prefix = commonPrefix(key, toSplit)\n      tree[prefix] = { [toSplit.slice(prefix.length)]: tree[toSplit] }\n      delete tree[toSplit]\n      return createPath(tree[prefix], key.slice(prefix.length))\n    }\n    return tree[key]\n  }\n  return createPath(tree[nodeKey], key.slice(nodeKey.length))\n}\n\nconst commonPrefix = function (a, b, i = 0, length = Math.min(a.length, b.length), prefix = '') {\n  if (i >= length) { return prefix }\n  if (a[i] !== b[i]) { return prefix }\n  return commonPrefix(a, b, i + 1, length, prefix + a[i])\n}\n\nconst remove = function (tree, key) {\n  const [node, path] = trackDown(tree, key)\n  if (node === undefined) { return }\n  delete node[LEAF]\n  const keys = Object.keys(node)\n  if (keys.length === 0) { cleanup(path) }\n  if (keys.length === 1) { merge(path, keys[0], node[keys[0]]) }\n}\n\nconst cleanup = function (path) {\n  if (path.length === 0) { return }\n  const [node, key] = last(path)\n  delete node[key]\n  if (Object.keys(node).length === 0) {\n    cleanup(path.slice(0, -1))\n  }\n}\n\nconst merge = function (path, key, value) {\n  if (path.length === 0) { return }\n  const [node, nodeKey] = last(path)\n  node[nodeKey + key] = value\n  delete node[nodeKey]\n}\n\nconst last = function (array) {\n  return array[array.length - 1]\n}\n\nexport default SearchableMap\nexport { SearchableMap }\n","import SearchableMap from './SearchableMap/SearchableMap.js'\n\nconst OR = 'or'\nconst AND = 'and'\n\n/**\n* MiniSearch is the main entrypoint class, and represents a full-text search\n* engine.\n*\n* @example\n* const documents = [\n*   {\n*     id: 1,\n*     title: 'Moby Dick',\n*     text: 'Call me Ishmael. Some years ago...',\n*     category: 'fiction'\n*   },\n*   {\n*     id: 2,\n*     title: 'Zen and the Art of Motorcycle Maintenance',\n*     text: 'I can see by my watch...',\n*     category: 'fiction'\n*   },\n*   {\n*     id: 3,\n*     title: 'Neuromancer',\n*     text: 'The sky above the port was...',\n*     category: 'fiction'\n*   },\n*   {\n*     id: 4,\n*     title: 'Zen and the Art of Archery',\n*     text: 'At first sight it must seem...',\n*     category: 'non-fiction'\n*   },\n*   // ...and more\n* ]\n*\n* // Create a search engine that indexes the 'title' and 'text' fields for\n* // full-text search. Search results will include 'title' and 'category' (plus the\n* // id field, that is always stored and returned)\n* const miniSearch = MiniSearch.new({\n*   fields: ['title', 'text'],\n*   storeFields: ['title', 'category']\n* })\n*\n* // Add documents to the index\n* miniSearch.addAll(documents)\n*\n* // Search for documents:\n* let results = miniSearch.search('zen art motorcycle')\n* // => [\n*   { id: 2, title: 'Zen and the Art of Motorcycle Maintenance', category: 'fiction', score: 2.77258 },\n*   { id: 4, title: 'Zen and the Art of Archery', category: 'non-fiction', score: 1.38629 }\n* ]\n* */\nclass MiniSearch {\n  /**\n   * @callback MiniSearch~extractField\n   * @param {Object} document - A document object\n   * @param {string} fieldName - Name of the field to extract\n   * @return string - Value of the field\n   */\n\n  /**\n   * @callback MiniSearch~tokenize\n   * @param {string} text - Text to tokenize\n   * @param {?string} fieldName - Name of the field to tokenize\n   * @return string[] - Tokenized terms\n   */\n\n  /**\n   * @callback MiniSearch~processTerm\n   * @param {string} text - The text to tokenize\n   * @param {?string} fieldName - The name of the field to tokenize\n   * @return string|null|undefined|false - Processed term, or a falsy value to discard the term\n   */\n\n  /**\n  * @param {Object} options - Configuration options\n  * @param {Array<string>} options.fields - Fields to be indexed. Required.\n  * @param {string} [options.idField='id'] - ID field, uniquely identifying a document\n  * @param {Array<string>} [options.storeFields] - Fields to store, so that search results would include them. By default none, so resuts would only contain the id field.\n  * @param {MiniSearch~extractField} [options.extractField] - Function used to get the value of a field in a document\n  * @param {MiniSearch~tokenize} [options.tokenize] - Function used to split a field into individual terms\n  * @param {MiniSearch~processTerm} [options.processTerm] - Function used to process a term before indexing it or searching\n  * @param {Object} [options.searchOptions] - Default search options (see the `search` method for details)\n  *\n  * @example\n  * // Create a search engine that indexes the 'title' and 'text' fields of your\n  * // documents:\n  * const miniSearch = MiniSearch.new({ fields: ['title', 'text'] })\n  *\n  * @example\n  * // Your documents are assumed to include a unique 'id' field, but if you want\n  * // to use a different field for document identification, you can set the\n  * // 'idField' option:\n  * const miniSearch = MiniSearch.new({ idField: 'key', fields: ['title', 'text'] })\n  *\n  * @example\n  * // The full set of options (here with their default value) is:\n  * const miniSearch = MiniSearch.new({\n  *   // idField: field that uniquely identifies a document\n  *   idField: 'id',\n  *\n  *   // extractField: function used to get the value of a field in a document.\n  *   // By default, it assumes the document is a flat object with field names as\n  *   // property keys and field values as string property values, but custom logic\n  *   // can be implemented by setting this option to a custom extractor function.\n  *   extractField: (document, fieldName) => document[fieldName],\n  *\n  *   // tokenize: function used to split fields into individual terms. By\n  *   // default, it is also used to tokenize search queries, unless a specific\n  *   // `tokenize` search option is supplied. When tokenizing an indexed field,\n  *   // the field name is passed as the second argument.\n  *   tokenize: (string, _fieldName) => string.split(SPACE_OR_PUNCTUATION),\n  *\n  *   // processTerm: function used to process each tokenized term before\n  *   // indexing. It can be used for stemming and normalization. Return a falsy\n  *   // value in order to discard a term. By default, it is also used to process\n  *   // search queries, unless a specific `processTerm` option is supplied as a\n  *   // search option. When processing a term from a indexed field, the field\n  *   // name is passed as the second argument.\n  *   processTerm: (term, _fieldName) => term.toLowerCase(),\n  *\n  *   // searchOptions: default search options, see the `search` method for\n  *   // details\n  *   searchOptions: undefined,\n  *\n  *   // fields: document fields to be indexed. Mandatory, but not set by default\n  *   fields: undefined\n  *\n  *   // storeFields: document fields to be stored and returned as part of the\n  *   // search results.\n  *   storeFields: []\n  * })\n  */\n  constructor (options = {}) {\n    /** @private */\n    this._options = { ...defaultOptions, ...options }\n\n    this._options.searchOptions = { ...defaultSearchOptions, ...(this._options.searchOptions || {}) }\n    const { fields } = this._options\n\n    if (fields == null) {\n      throw new Error('MiniSearch: option \"fields\" must be provided')\n    }\n\n    /** @private */\n    this._index = new SearchableMap()\n\n    /** @private */\n    this._documentCount = 0\n\n    /** @private */\n    this._documentIds = {}\n\n    /** @private */\n    this._fieldIds = {}\n\n    /** @private */\n    this._fieldLength = {}\n\n    /** @private */\n    this._averageFieldLength = {}\n\n    /** @private */\n    this._nextId = 0\n\n    /** @private */\n    this._storedFields = {}\n\n    addFields(this, fields)\n  }\n\n  /**\n  * Adds a document to the index\n  *\n  * @param {Object} document - the document to be indexed\n  */\n  add (document) {\n    const { extractField, tokenize, processTerm, fields, idField } = this._options\n    if (getOwnProperty(document, idField) == null) {\n      throw new Error(`MiniSearch: document does not have ID field \"${idField}\"`)\n    }\n    const shortDocumentId = addDocumentId(this, document[idField])\n    saveStoredFields(this, shortDocumentId, document)\n\n    fields.forEach(field => {\n      const fieldValue = extractField(document, field)\n      const tokens = tokenize(fieldValue == null ? '' : fieldValue.toString(), field)\n\n      addFieldLength(this, shortDocumentId, this._fieldIds[field], this.documentCount - 1, tokens.length)\n\n      tokens.forEach(term => {\n        const processedTerm = processTerm(term, field)\n        if (isTruthy(processedTerm)) {\n          addTerm(this, this._fieldIds[field], shortDocumentId, processedTerm)\n        }\n      })\n    })\n  }\n\n  /**\n  * Adds all the given documents to the index\n  *\n  * @param {Object[]} documents - an array of documents to be indexed\n  */\n  addAll (documents) {\n    documents.forEach(document => this.add(document))\n  }\n\n  /**\n  * Adds all the given documents to the index asynchronously.\n  *\n  * Returns a promise that resolves to undefined when the indexing is done. This\n  * method is useful when index many documents, to avoid blocking the main\n  * thread. The indexing is performed asynchronously and in chunks.\n  *\n  * @param {Object[]} documents - an array of documents to be indexed\n  * @param {Object} [options] - Configuration options\n  * @param {number} [options.chunkSize] - Size of the document chunks indexed, 10 by default\n  * @return {Promise} A promise resolving to `null` when the indexing is done\n  */\n  addAllAsync (documents, options = {}) {\n    const { chunkSize = 10 } = options\n    const acc = { chunk: [], promise: Promise.resolve(null) }\n\n    const { chunk, promise } = documents.reduce(({ chunk, promise }, document, i) => {\n      chunk.push(document)\n      if ((i + 1) % chunkSize === 0) {\n        return { chunk: [], promise: promise.then(() => this.addAll(chunk)) }\n      } else {\n        return { chunk, promise }\n      }\n    }, acc)\n\n    return promise.then(() => this.addAll(chunk))\n  }\n\n  /**\n  * Removes the given document from the index.\n  *\n  * The document to delete must NOT have changed between indexing and deletion,\n  * otherwise the index will be corrupted. Therefore, when reindexing a document\n  * after a change, the correct order of operations is:\n  *\n  *   1. remove old version\n  *   2. apply changes\n  *   3. index new version\n  *\n  * @param {Object} document - the document to be removed\n  */\n  remove (document) {\n    const { tokenize, processTerm, extractField, fields, idField } = this._options\n\n    if (getOwnProperty(document, idField) == null) {\n      throw new Error(`MiniSearch: document does not have ID field \"${idField}\"`)\n    }\n\n    const [shortDocumentId] = Object.entries(this._documentIds)\n      .find(([_, longId]) => document[idField] === longId) || []\n\n    if (shortDocumentId == null) {\n      throw new Error(`MiniSearch: cannot remove document with ID ${document[idField]}: it is not in the index`)\n    }\n\n    fields.filter(field => getOwnProperty(document, field) != null).forEach(field => {\n      const tokens = tokenize(extractField(document, field) || '', field)\n\n      tokens.forEach(term => {\n        const processedTerm = processTerm(term, field)\n        if (isTruthy(processedTerm)) {\n          removeTerm(this, this._fieldIds[field], shortDocumentId, processedTerm)\n        }\n      })\n    })\n\n    delete this._storedFields[shortDocumentId]\n    delete this._documentIds[shortDocumentId]\n    this._documentCount -= 1\n  }\n\n  /**\n  * Removes all the given documents from the index. If called with no arguments,\n  * it removes _all_ documents from the index.\n  *\n  * @param {Array<Object>} [documents] - the documents to be removed\n  */\n  removeAll (documents) {\n    if (arguments.length === 0) {\n      this._index = new SearchableMap()\n      this._documentCount = 0\n      this._documentIds = {}\n      this._fieldLength = {}\n      this._averageFieldLength = {}\n      this._storedFields = {}\n      this._nextId = 0\n    } else {\n      documents.forEach(document => this.remove(document))\n    }\n  }\n\n  /**\n   * @callback MiniSearch~prefixFn\n   * @param {string} term - Search term\n   * @param {number} i - Index of the term in the query terms array\n   * @param {string[]} terms - Array of all query terms\n   * @return boolean - `true` to perform prefix search, `false` to not perform it\n   */\n\n  /**\n   * @callback MiniSearch~fuzzyFn\n   * @param {string} term - Search term\n   * @param {number} i - Index of the search term in the tokenized search query\n   * @param {string[]} terms - Array of all query terms\n   * @return number|false - Maximum edit distance, or `false` to not perform fuzzy search\n   */\n\n  /**\n   * @callback MiniSearch~filter\n   * @param {Object} result - A search result\n   * @return boolean - `true` to keep the result, `false` to filter it out\n   */\n\n  /**\n  * Search for documents matching the given search query.\n  *\n  * The result is a list of scored document IDs matching the query, sorted by\n  * descending score, and each including data about which terms were matched and\n  * in which fields.\n  *\n  * @param {string} queryString - Query string to search for\n  * @param {Object} [options] - Search options. Each option, if not given, defaults to the corresponding value of `searchOptions` given to the constructor, or to the library default.\n  * @param {Array<string>} [options.fields] - Fields to search in. If omitted, all fields are searched\n  * @param {Object<string, number>} [options.boost] - Key-value object of boosting values for fields\n  * @param {boolean|MiniSearch~prefixFn} [options.prefix=false] - Whether to perform prefix search. Value can be a boolean, or a function computing the boolean from each tokenized and processed query term. If a function is given, it is called with the following arguments: `term: string` - the query term; `i: number` - the term index in the query terms; `terms: Array<string>` - the array of query terms.\n  * @param {number|false|MiniSearch~fuzzyFn} [options.fuzzy=false] - If set to a number greater than or equal 1, it performs fuzzy search within a maximum edit distance equal to that value. If set to a number less than 1, it performs fuzzy search with a maximum edit distance equal to the term length times the value, rouded at the nearest integer. If set to a function, it calls the function for each tokenized and processed query term and expects a numeric value indicating the maximum edit distance, or a falsy falue if fuzzy search should not be performed. If a function is given, it is called with the following arguments: `term: string` - the query term; `i: number` - the term index in the query terms; `terms: Array<string>` - the array of query terms.\n  * @param {string} [options.combineWith='OR'] - How to combine term queries (it can be 'OR' or 'AND')\n  * @param {MiniSearch~tokenize} [options.tokenize] - Function used to tokenize the search query. It defaults to the same tokenizer used for indexing.\n  * @param {MiniSearch~processTerm} [options.processTerm] - Function used to process each search term. Return a falsy value to discard a term. Defaults to the same function used to process terms upon indexing.\n  * @param {MiniSearch~filter} [options.filter] - Function used to filter search results, for example on the basis of stored fields\n  * @return {Array<{ id: any, score: number, match: Object }>} A sorted array of scored document IDs matching the search\n  *\n  * @example\n  * // Search for \"zen art motorcycle\" with default options: terms have to match\n  * // exactly, and individual terms are joined with OR\n  * miniSearch.search('zen art motorcycle')\n  * // => [ { id: 2, score: 2.77258, match: { ... } }, { id: 4, score: 1.38629, match: { ... } } ]\n  *\n  * @example\n  * // Search only in the 'title' field\n  * miniSearch.search('zen', { fields: ['title'] })\n  *\n  * @example\n  * // Boost a field\n  * miniSearch.search('zen', { boost: { title: 2 } })\n  *\n  * @example\n  * // Search for \"moto\" with prefix search (it will match documents\n  * // containing terms that start with \"moto\" or \"neuro\")\n  * miniSearch.search('moto neuro', { prefix: true })\n  *\n  * @example\n  * // Search for \"ismael\" with fuzzy search (it will match documents containing\n  * // terms similar to \"ismael\", with a maximum edit distance of 0.2 term.length\n  * // (rounded to nearest integer)\n  * miniSearch.search('ismael', { fuzzy: 0.2 })\n  *\n  * @example\n  * // Mix of exact match, prefix search, and fuzzy search\n  * miniSearch.search('ismael mob', {\n  *  prefix: true,\n  *  fuzzy: 0.2\n  * })\n  *\n  * @example\n  * // Perform fuzzy and prefix search depending on the search term. Here\n  * // performing prefix and fuzzy search only on terms longer than 3 characters\n  * miniSearch.search('ismael mob', {\n  *  prefix: term => term.length > 3\n  *  fuzzy: term => term.length > 3 ? 0.2 : null\n  * })\n  *\n  * @example\n  * // Combine search terms with AND (to match only documents that contain both\n  * // \"motorcycle\" and \"art\")\n  * miniSearch.search('motorcycle art', { combineWith: 'AND' })\n  *\n  * @example\n  * // Filter only results in the 'fiction' category (assuming that 'category'\n  * // is a stored field)\n  * miniSearch.search('motorcycle art', {\n  *   filter: (result) => result.category === 'fiction'\n  * })\n  */\n  search (queryString, options = {}) {\n    const { tokenize, processTerm, searchOptions } = this._options\n    options = { tokenize, processTerm, ...searchOptions, ...options }\n    const { tokenize: searchTokenize, processTerm: searchProcessTerm } = options\n    const queries = searchTokenize(queryString)\n      .map((term) => searchProcessTerm(term))\n      .filter(isTruthy)\n      .map(termToQuery(options))\n    const results = queries.map(query => this.executeQuery(query, options))\n    const combinedResults = this.combineResults(results, options.combineWith)\n\n    return Object.entries(combinedResults)\n      .reduce((results, [docId, { score, match, terms, tfScores }]) => {\n        const result = {\n          id: this._documentIds[docId],\n          terms: uniq(terms),\n          allTerms: terms,\n          score,\n          match,\n\t  tfScores\n        }\n        Object.assign(result, this._storedFields[docId])\n        if (options.filter == null || options.filter(result)) {\n          results.push(result)\n        }\n        return results\n      }, [])\n      .sort(({ score: a }, { score: b }) => a < b ? 1 : -1)\n  }\n\n  /**\n  * Provide suggestions for the given search query\n  *\n  * The result is a list of suggested modified search queries, derived from the\n  * given search query, each with a relevance score, sorted by descending score.\n  *\n  * @param {string} queryString - Query string to be expanded into suggestions\n  * @param {Object} [options] - Search options. The supported options and default values are the same as for the `search` method, except that by default prefix search is performed on the last term in the query.\n  * @return {Array<{ suggestion: string, score: number }>} A sorted array of suggestions sorted by relevance score.\n  *\n  * @example\n  * // Get suggestions for 'neuro':\n  * miniSearch.autoSuggest('neuro')\n  * // => [ { suggestion: 'neuromancer', terms: [ 'neuromancer' ], score: 0.46240 } ]\n  *\n  * @example\n  * // Get suggestions for 'zen ar':\n  * miniSearch.autoSuggest('zen ar')\n  * // => [\n  * //  { suggestion: 'zen archery art', terms: [ 'zen', 'archery', 'art' ], score: 1.73332 },\n  * //  { suggestion: 'zen art', terms: [ 'zen', 'art' ], score: 1.21313 }\n  * // ]\n  *\n  * @example\n  * // Correct spelling mistakes using fuzzy search:\n  * miniSearch.autoSuggest('neromancer', { fuzzy: 0.2 })\n  * // => [ { suggestion: 'neuromancer', terms: [ 'neuromancer' ], score: 1.03998 } ]\n  *\n  * @example\n  * // Get suggestions for 'zen ar', but only within the 'fiction' category\n  * // (assuming that 'category' is a stored field):\n  * miniSearch.autoSuggest('zen ar', {\n  *   filter: (result) => result.category === 'fiction'\n  * })\n  * // => [\n  * //  { suggestion: 'zen archery art', terms: [ 'zen', 'archery', 'art' ], score: 1.73332 },\n  * //  { suggestion: 'zen art', terms: [ 'zen', 'art' ], score: 1.21313 }\n  * // ]\n  */\n  autoSuggest (queryString, options = {}) {\n    options = { ...defaultAutoSuggestOptions, ...options }\n    const suggestions = this.search(queryString, options).reduce((suggestions, { score, terms }) => {\n      const phrase = terms.join(' ')\n      if (suggestions[phrase] == null) {\n        suggestions[phrase] = { score, terms, count: 1 }\n      } else {\n        suggestions[phrase].score += score\n        suggestions[phrase].count += 1\n      }\n      return suggestions\n    }, {})\n    return Object.entries(suggestions)\n      .map(([suggestion, { score, terms, count }]) => ({ suggestion, terms, score: score / count }))\n      .sort(({ score: a }, { score: b }) => a < b ? 1 : -1)\n  }\n\n  /**\n  * Number of documents in the index\n  *\n  * @type {number}\n  */\n  get documentCount () {\n    return this._documentCount\n  }\n\n  /**\n  * Deserializes a JSON index (serialized with `miniSearch.toJSON()`) and\n  * instantiates a MiniSearch instance. It should be given the same options\n  * originally used when serializing the index.\n  *\n  * **Warning:** JSON (de)serialization of the index is currently tightly\n  * coupled to the index implementation. For this reason, the current\n  * implementation is to be considered a _beta_ feature, subject to breaking\n  * changes changes in future releases. If a breaking change is introduced,\n  * though, it will be properly reported in the changelog.\n  *\n  * @param {string} json - JSON-serialized index\n  * @param {Object} options - configuration options, same as the constructor\n  * @return {MiniSearch} an instance of MiniSearch\n  */\n  static loadJSON (json, options) {\n    if (options == null) {\n      throw new Error('MiniSearch: loadJSON should be given the same options used when serializing the index')\n    }\n    return MiniSearch.loadJS(JSON.parse(json), options)\n  }\n\n  /**\n  * Get the default value of an option. It will throw an error if no option with\n  * the given name exists.\n  *\n  * @param {string} optionName - name of the option\n  * @return {any} the default value of the given option\n  *\n  * @example\n  * // Get default tokenizer\n  * MiniSearch.getDefault('tokenize')\n  *\n  * @example\n  * // Get default term processor\n  * MiniSearch.getDefault('processTerm')\n  *\n  * @example\n  * // Unknown options will throw an error\n  * MiniSearch.getDefault('notExisting')\n  * // => throws 'MiniSearch: unknown option \"notExisting\"'\n  */\n  static getDefault (optionName) {\n    if (defaultOptions.hasOwnProperty(optionName)) {\n      return defaultOptions[optionName]\n    } else {\n      throw new Error(`MiniSearch: unknown option \"${optionName}\"`)\n    }\n  }\n\n  /**\n  * @private\n  */\n  static loadJS (js, options = {}) {\n    const {\n      index,\n      documentCount,\n      nextId,\n      documentIds,\n      fieldIds,\n      fieldLength,\n      averageFieldLength,\n      storedFields\n    } = js\n    const miniSearch = new MiniSearch(options)\n    miniSearch._index = new SearchableMap(index._tree, index._prefix)\n    miniSearch._documentCount = documentCount\n    miniSearch._nextId = nextId\n    miniSearch._documentIds = documentIds\n    miniSearch._fieldIds = fieldIds\n    miniSearch._fieldLength = fieldLength\n    miniSearch._averageFieldLength = averageFieldLength\n    miniSearch._fieldIds = fieldIds\n    miniSearch._storedFields = storedFields || {}\n    return miniSearch\n  }\n\n  /**\n  * @private\n  * @ignore\n  */\n  executeQuery (query, options = {}) {\n    options = { ...this._options.searchOptions, ...options }\n\n    const boosts = (options.fields || this._options.fields).reduce((boosts, field) =>\n      ({ ...boosts, [field]: getOwnProperty(boosts, field) || 1 }), options.boost || {})\n\n    const {\n      boostDocument,\n      weights: { fuzzy: fuzzyWeight = 0.9, prefix: prefixWeight = 0.75 }\n    } = options\n\n    const exactMatch = termResults(this, query.term, boosts, boostDocument, this._index.get(query.term))\n\n    if (!query.fuzzy && !query.prefix) { return exactMatch }\n\n    const results = [exactMatch]\n\n    if (query.prefix) {\n      this._index.atPrefix(query.term).forEach((term, data) => {\n        const weightedDistance = (0.3 * (term.length - query.term.length)) / term.length\n        results.push(termResults(this, term, boosts, boostDocument, data, prefixWeight, weightedDistance))\n      })\n    }\n\n    if (query.fuzzy) {\n      const maxDistance = query.fuzzy < 1 ? Math.round(query.term.length * query.fuzzy) : query.fuzzy\n      Object.entries(this._index.fuzzyGet(query.term, maxDistance)).forEach(([term, [data, distance]]) => {\n        const weightedDistance = distance / term.length\n        results.push(termResults(this, term, boosts, boostDocument, data, fuzzyWeight, weightedDistance))\n      })\n    }\n\n    return results.reduce(combinators[OR], {})\n  }\n\n  /**\n  * @private\n  * @ignore\n  */\n  combineResults (results, combineWith = OR) {\n    if (results.length === 0) { return {} }\n    const operator = combineWith.toLowerCase()\n    return results.reduce(combinators[operator], null)\n  }\n\n  /**\n  * Allows serialization of the index to JSON, to possibly store it and later\n  * deserialize it with MiniSearch.loadJSON\n  *\n  * **Warning:** JSON (de)serialization of the index is currently tightly\n  * coupled to the index implementation. For this reason, the current\n  * implementation is to be considered a _beta_ feature, subject to breaking\n  * changes changes in future releases. If a breaking change is introduced,\n  * though, it will be reported in the changelog.\n  *\n  * @return {Object} the serializeable representation of the search index\n  */\n  toJSON () {\n    return {\n      index: this._index,\n      documentCount: this._documentCount,\n      nextId: this._nextId,\n      documentIds: this._documentIds,\n      fieldIds: this._fieldIds,\n      fieldLength: this._fieldLength,\n      averageFieldLength: this._averageFieldLength,\n      storedFields: this._storedFields\n    }\n  }\n}\n\nMiniSearch.SearchableMap = SearchableMap\n\nconst addTerm = function (self, fieldId, documentId, term) {\n  self._index.update(term, indexData => {\n    indexData = indexData || {}\n    const fieldIndex = indexData[fieldId] || { df: 0, ds: {} }\n    if (fieldIndex.ds[documentId] == null) { fieldIndex.df += 1 }\n    fieldIndex.ds[documentId] = (fieldIndex.ds[documentId] || 0) + 1\n    return { ...indexData, [fieldId]: fieldIndex }\n  })\n}\n\nconst removeTerm = function (self, fieldId, documentId, term) {\n  if (!self._index.has(term)) {\n    warnDocumentChanged(self, documentId, fieldId, term)\n    return\n  }\n  self._index.update(term, indexData => {\n    const fieldIndex = indexData[fieldId]\n    if (fieldIndex == null || fieldIndex.ds[documentId] == null) {\n      warnDocumentChanged(self, documentId, fieldId, term)\n      return indexData\n    }\n    if (fieldIndex.ds[documentId] <= 1) {\n      if (fieldIndex.df <= 1) {\n        delete indexData[fieldId]\n        return indexData\n      }\n      fieldIndex.df -= 1\n    }\n    if (fieldIndex.ds[documentId] <= 1) {\n      delete fieldIndex.ds[documentId]\n      return indexData\n    }\n    fieldIndex.ds[documentId] -= 1\n    return { ...indexData, [fieldId]: fieldIndex }\n  })\n  if (Object.keys(self._index.get(term)).length === 0) {\n    self._index.delete(term)\n  }\n}\n\nconst warnDocumentChanged = function (self, shortDocumentId, fieldId, term) {\n  if (console == null || console.warn == null) { return }\n  const fieldName = Object.entries(self._fieldIds).find(([name, id]) => id === fieldId)[0]\n  console.warn(`MiniSearch: document with ID ${self._documentIds[shortDocumentId]} has changed before removal: term \"${term}\" was not present in field \"${fieldName}\". Removing a document after it has changed can corrupt the index!`)\n}\n\nconst addDocumentId = function (self, documentId) {\n  const shortDocumentId = self._nextId.toString(36)\n  self._documentIds[shortDocumentId] = documentId\n  self._documentCount += 1\n  self._nextId += 1\n  return shortDocumentId\n}\n\nconst addFields = function (self, fields) {\n  fields.forEach((field, i) => { self._fieldIds[field] = i })\n}\n\nconst termResults = function (self, term, boosts, boostDocument, indexData, weight = 1, editDistance = 0) {\n  if (indexData == null) { return {} }\n  return Object.entries(boosts).reduce((results, [field, boost]) => {\n    const fieldId = self._fieldIds[field]\n    const { df, ds } = indexData[fieldId] || { ds: {} }\n    Object.entries(ds).forEach(([documentId, tf]) => {\n      const docBoost = boostDocument ? boostDocument(self._documentIds[documentId], term) : 1\n      if (!docBoost) { return }\n      const normalizedLength = self._fieldLength[documentId][fieldId] / self._averageFieldLength[fieldId]\n      results[documentId] = results[documentId] || { score: 0, match: {}, terms: [] }\n      results[documentId].terms.push(term)\n      results[documentId].match[term] = getOwnProperty(results[documentId].match, term) || []\n      results[documentId].score += docBoost * score(tf, df, self._documentCount, normalizedLength, boost, editDistance)\n      results[documentId].match[term].push(field)\n    })\n    return results\n  }, {})\n}\n\nconst getOwnProperty = function (object, property) {\n  return Object.prototype.hasOwnProperty.call(object, property) ? object[property] : undefined\n}\n\nconst addFieldLength = function (self, documentId, fieldId, count, length) {\n  self._averageFieldLength[fieldId] = self._averageFieldLength[fieldId] || 0\n  const totalLength = (self._averageFieldLength[fieldId] * count) + length\n  self._fieldLength[documentId] = self._fieldLength[documentId] || {}\n  self._fieldLength[documentId][fieldId] = length\n  self._averageFieldLength[fieldId] = totalLength / (count + 1)\n}\n\nconst saveStoredFields = function (self, documentId, doc) {\n  const { storeFields, extractField } = self._options\n  if (storeFields == null || storeFields.length === 0) { return }\n  self._storedFields[documentId] = self._storedFields[documentId] || {}\n\n  storeFields.forEach((fieldName) => {\n    const fieldValue = extractField(doc, fieldName)\n    if (fieldValue === undefined) { return }\n    self._storedFields[documentId][fieldName] = fieldValue\n  })\n}\n\nconst combinators = {\n  [OR]: function (a, b) {\n    return Object.entries(b).reduce((combined, [documentId, { score, match, terms }]) => {\n      if (combined[documentId] == null) {\n        combined[documentId] = { score, match, terms, tfScores: [] }\n      } else {\n        combined[documentId].score += score\n        combined[documentId].score *= 1.5\n        combined[documentId].tfScores = [...combined[documentId].tfScores, score]\n        combined[documentId].terms = [...combined[documentId].terms, ...terms]\n        Object.assign(combined[documentId].match, match)\n      }\n      return combined\n    }, a || {})\n  },\n  [AND]: function (a, b) {\n    if (a == null) { return b }\n    return Object.entries(b).reduce((combined, [documentId, { score, match, terms }]) => {\n      if (a[documentId] === undefined) { return combined }\n      combined[documentId] = combined[documentId] || {}\n      combined[documentId].score = a[documentId].score + score\n      combined[documentId].tfScores = [...combined[documentId].tfScores, score]\n      combined[documentId].match = { ...a[documentId].match, ...match }\n      combined[documentId].terms = [...a[documentId].terms, ...terms]\n      return combined\n    }, {})\n  }\n}\n\nconst tfIdf = function (tf, df, n) {\n  return tf * Math.log(n / df)\n}\n\nconst score = function (termFrequency, documentFrequency, documentCount, normalizedLength, boost, editDistance) {\n  const weight = boost / (1 + (0.333 * boost * editDistance))\n  return weight * tfIdf(termFrequency, documentFrequency, documentCount) / normalizedLength\n}\n\nconst termToQuery = (options) => (term, i, terms) => {\n  const fuzzy = (typeof options.fuzzy === 'function')\n    ? options.fuzzy(term, i, terms)\n    : options.fuzzy\n  const prefix = (typeof options.prefix === 'function')\n    ? options.prefix(term, i, terms)\n    : options.prefix\n  return { term, fuzzy, prefix }\n}\n\nconst uniq = function (array) {\n  return array.filter((element, i, array) => array.indexOf(element) === i)\n}\n\nconst isTruthy = (x) => !!x\n\nconst defaultOptions = {\n  idField: 'id',\n  extractField: (document, fieldName) => document[fieldName],\n  tokenize: (string, _fieldName) => string.split(SPACE_OR_PUNCTUATION),\n  processTerm: (term, _fieldName) => term.toLowerCase(),\n  fields: undefined,\n  searchOptions: undefined,\n  storeFields: []\n}\n\nconst defaultSearchOptions = {\n  combineWith: OR,\n  prefix: false,\n  fuzzy: false,\n  weights: {}\n}\n\nconst defaultAutoSuggestOptions = {\n  prefix: (term, i, terms) => i === terms.length - 1\n}\n\n// This regular expression matches any Unicode space or punctuation character\n// Adapted from https://unicode.org/cldr/utility/list-unicodeset.jsp?a=%5Cp%7BZ%7D%5Cp%7BP%7D&abb=on&c=on&esc=on\nconst SPACE_OR_PUNCTUATION = /[\\n\\r -#%-*,-/:;?@[-\\]_{}\\u00A0\\u00A1\\u00A7\\u00AB\\u00B6\\u00B7\\u00BB\\u00BF\\u037E\\u0387\\u055A-\\u055F\\u0589\\u058A\\u05BE\\u05C0\\u05C3\\u05C6\\u05F3\\u05F4\\u0609\\u060A\\u060C\\u060D\\u061B\\u061E\\u061F\\u066A-\\u066D\\u06D4\\u0700-\\u070D\\u07F7-\\u07F9\\u0830-\\u083E\\u085E\\u0964\\u0965\\u0970\\u09FD\\u0A76\\u0AF0\\u0C77\\u0C84\\u0DF4\\u0E4F\\u0E5A\\u0E5B\\u0F04-\\u0F12\\u0F14\\u0F3A-\\u0F3D\\u0F85\\u0FD0-\\u0FD4\\u0FD9\\u0FDA\\u104A-\\u104F\\u10FB\\u1360-\\u1368\\u1400\\u166E\\u1680\\u169B\\u169C\\u16EB-\\u16ED\\u1735\\u1736\\u17D4-\\u17D6\\u17D8-\\u17DA\\u1800-\\u180A\\u1944\\u1945\\u1A1E\\u1A1F\\u1AA0-\\u1AA6\\u1AA8-\\u1AAD\\u1B5A-\\u1B60\\u1BFC-\\u1BFF\\u1C3B-\\u1C3F\\u1C7E\\u1C7F\\u1CC0-\\u1CC7\\u1CD3\\u2000-\\u200A\\u2010-\\u2029\\u202F-\\u2043\\u2045-\\u2051\\u2053-\\u205F\\u207D\\u207E\\u208D\\u208E\\u2308-\\u230B\\u2329\\u232A\\u2768-\\u2775\\u27C5\\u27C6\\u27E6-\\u27EF\\u2983-\\u2998\\u29D8-\\u29DB\\u29FC\\u29FD\\u2CF9-\\u2CFC\\u2CFE\\u2CFF\\u2D70\\u2E00-\\u2E2E\\u2E30-\\u2E4F\\u3000-\\u3003\\u3008-\\u3011\\u3014-\\u301F\\u3030\\u303D\\u30A0\\u30FB\\uA4FE\\uA4FF\\uA60D-\\uA60F\\uA673\\uA67E\\uA6F2-\\uA6F7\\uA874-\\uA877\\uA8CE\\uA8CF\\uA8F8-\\uA8FA\\uA8FC\\uA92E\\uA92F\\uA95F\\uA9C1-\\uA9CD\\uA9DE\\uA9DF\\uAA5C-\\uAA5F\\uAADE\\uAADF\\uAAF0\\uAAF1\\uABEB\\uFD3E\\uFD3F\\uFE10-\\uFE19\\uFE30-\\uFE52\\uFE54-\\uFE61\\uFE63\\uFE68\\uFE6A\\uFE6B\\uFF01-\\uFF03\\uFF05-\\uFF0A\\uFF0C-\\uFF0F\\uFF1A\\uFF1B\\uFF1F\\uFF20\\uFF3B-\\uFF3D\\uFF3F\\uFF5B\\uFF5D\\uFF5F-\\uFF65]+/u\n\nexport default MiniSearch\n"],"names":["TreeIterator","set","type","node","_tree","keys","Object","path","length","next","value","dive","backtrack","done","last","LEAF","result","push","pop","key","_prefix","map","filter","join","VALUES","KEYS","Symbol","iterator","ENTRIES","array","fuzzySearch","query","maxDistance","stack","distance","i","results","innerStack","edit","forEach","k","totDistance","Infinity","d","withinDistance","a","b","ia","ib","NONE","ADD","DELETE","CHANGE","SearchableMap","tree","prefix","atPrefix","startsWith","Error","trackDown","slice","undefined","parentNode","nodeKey","find","clear","_size","delete","remove","entries","fn","fuzzyGet","maxEditDistance","get","lookup","has","hasOwnProperty","createPath","update","values","from","fromObject","object","toSplit","commonPrefix","Math","min","cleanup","merge","OR","AND","MiniSearch","options","_options","defaultOptions","searchOptions","defaultSearchOptions","fields","_index","_documentCount","_documentIds","_fieldIds","_fieldLength","_averageFieldLength","_nextId","_storedFields","addFields","add","document","extractField","tokenize","processTerm","idField","getOwnProperty","shortDocumentId","addDocumentId","saveStoredFields","field","fieldValue","tokens","toString","addFieldLength","documentCount","term","processedTerm","isTruthy","addTerm","addAll","documents","addAllAsync","chunkSize","acc","chunk","promise","Promise","resolve","reduce","then","longId","removeTerm","removeAll","arguments","search","queryString","searchTokenize","searchProcessTerm","queries","termToQuery","executeQuery","combinedResults","combineResults","combineWith","docId","score","match","terms","tfScores","id","uniq","allTerms","assign","sort","autoSuggest","defaultAutoSuggestOptions","suggestions","phrase","count","suggestion","loadJSON","json","loadJS","JSON","parse","getDefault","optionName","js","index","nextId","documentIds","fieldIds","fieldLength","averageFieldLength","storedFields","miniSearch","boosts","boost","boostDocument","weights","fuzzy","fuzzyWeight","prefixWeight","exactMatch","termResults","data","weightedDistance","round","combinators","operator","toLowerCase","toJSON","self","fieldId","documentId","indexData","fieldIndex","df","ds","warnDocumentChanged","console","warn","fieldName","weight","editDistance","tf","docBoost","normalizedLength","property","prototype","call","totalLength","doc","storeFields","combined","tfIdf","n","log","termFrequency","documentFrequency","element","indexOf","x","string","_fieldName","split","SPACE_OR_PUNCTUATION"],"mappings":"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MAQO;AACLwB,MAAAA,SAAS,CAACzF,OAAV,CAAkB,UAAAqE,QAAQ;AAAA,eAAI,MAAI,CAACxC,MAAL,CAAYwC,QAAZ,CAAJ;AAAA,OAA1B;AACD;AACF;AAED;AACF;AACA;AACA;AACA;AACA;AACA;;AAEE;AACF;AACA;AACA;AACA;AACA;AACA;;AAEE;AACF;AACA;AACA;AACA;;AAEE;AACF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;SACEkC,SAAA,gBAAQC,WAAR,EAAqBnD,OAArB,EAAmC;AAAA;;AAAA,QAAdA,OAAc;AAAdA,MAAAA,OAAc,GAAJ,EAAI;AAAA;;AAAA,0BACgB,KAAKC,QADrB;AAAA,QACzBiB,QADyB,mBACzBA,QADyB;AAAA,QACfC,WADe,mBACfA,WADe;AAAA,QACFhB,aADE,mBACFA,aADE;AAEjCH,IAAAA,OAAO;AAAKkB,MAAAA,QAAQ,EAARA,QAAL;AAAeC,MAAAA,WAAW,EAAXA;AAAf,OAA+BhB,aAA/B,GAAiDH,OAAjD,CAAP;AAFiC,oBAGoCA,OAHpC;AAAA,QAGfoD,cAHe,aAGzBlC,QAHyB;AAAA,QAGcmC,iBAHd,aAGClC,WAHD;AAIjC,QAAMmC,OAAO,GAAGF,cAAc,CAACD,WAAD,CAAd,CACb1H,GADa,CACT,UAACsG,IAAD;AAAA,aAAUsB,iBAAiB,CAACtB,IAAD,CAA3B;AAAA,KADS,EAEbrG,MAFa,CAENuG,QAFM,EAGbxG,GAHa,CAGT8H,WAAW,CAACvD,OAAD,CAHF,CAAhB;AAIA,QAAMxD,OAAO,GAAG8G,OAAO,CAAC7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"}